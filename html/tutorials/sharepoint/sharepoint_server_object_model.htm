<!DOCTYPE html>
<html lang="en-US">
<head>
<title>SharePoint - Server Object Model - Tutorialspoint</title>
<meta charset="utf-8">
<meta name="description" content="SharePoint - Server Object Model - In this chapter, we will take a look at the SharePoint Server Object Model. You use the SharePoint Server Object Model when you are writing code that will run i"/>
<meta name="keywords" content="C, C++, Python, Java, HTML, CSS, JavaScript, SQL, PHP, jQuery, XML, DOM, Bootstrap, Tutorials, Articles, Programming, training, learning, quiz, preferences, examples, code"/>
<link rel="canonical" href="https://www.tutorialspoint.com/sharepoint/sharepoint_server_object_model.htm" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=yes">
<script src="/theme/js/script-min-v2.js?v=3"></script>
<link rel="stylesheet" href="/theme/css/style-min-v2.css?v=6">
<script src="//services.bilsyndication.com/adv1/?d=901" defer="" async=""></script>
<script> var vitag = vitag || {};</script>
<script> vitag.outStreamConfig = { enablePC: false, enableMobile: false };</script>  
<style>
.right-menu .mui-btn {
    background-color:#0096c3;
}
a.demo {
    background:#0096c3;
}
li.heading {
    background:#0096c3;
}
.course-box{background:#0096c3}
.home-intro-sub p{color:#0096c3}
</style>
</head>
<body>
<header id="header">
<!-- Top sub-menu Starts Here -->
<div class="mui-appbar mui-container-fulid top-menu">
<div class="mui-container">
<div class="top-menu-item home">
<a href="https://www.tutorialspoint.com/index.htm" target="_blank" title="TutorialsPoint - Home"><i class="fal fa-home"></i> <span>Home</span></a>
</div>
<div class="top-menu-item qa">
<a href="https://www.tutorialspoint.com/about/about_careers.htm" target="_blank" title="Job @ Tutorials Point"><i class="fa fa-suitcase"></i> <span>Jobs</span></a>
</div>
<div class="top-menu-item tools">
<a href="https://www.tutorialspoint.com/online_dev_tools.htm" target="_blank" title="Tools - Online Development and Testing Tools"><i class="fal fa-cogs"></i> <span>Tools</span></a>
</div>
<div class="top-menu-item coding-ground">
<a href="https://www.tutorialspoint.com/codingground.htm" target="_blank" title="Coding Ground - Free Online IDE and Terminal"><i class="fal fa-code"></i> <span>Coding Ground </span></a> 
</div>
<div class="top-menu-item current-affairs">
<a href="https://www.tutorialspoint.com/current_affairs.htm" target="_blank" title="Daily Current Affairs"><i class="fal fa-layer-plus"></i> <span>Current Affairs</span></a>
</div>
<div class="top-menu-item upsc-notes">
<a href="https://www.tutorialspoint.com/upsc_ias_exams.htm" target="_blank" title="UPSC IAS Exams Notes - TutorialsPoint"><i class="fal fa-user-tie"></i> <span>UPSC Notes</span></a>
</div>      
<div class="top-menu-item online-tutoris">
<a href="https://www.tutorialspoint.com/tutor_connect/index.php" target="_blank" title="Top Online Tutors - Tutor Connect"><i class="fal fa-user"></i> <span>Online Tutors</span></a>
</div>
<div class="top-menu-item whiteboard">
<a href="https://www.tutorialspoint.com/whiteboard.htm" target="_blank" title="Free Online Whiteboard"><i class="fal fa-chalkboard"></i> <span>Whiteboard</span></a>
</div>
<div class="top-menu-item net-meeting">
<a href="https://www.tutorialspoint.com/netmeeting.php" target="_blank" title="A free tool for online video conferencing"><i class="fal fa-chalkboard-teacher"></i> <span>Net Meeting</span></a> 
</div>
<div class="top-menu-item articles">
<a href="https://www.tutorix.com" target="_blank" title="Tutorx - The Best Learning App" rel="nofollow"><i class="fal fa-video"></i> <span>Tutorix</span></a> 
</div>        
<div class="social-menu-item">
<a href="https://www.facebook.com/tutorialspointindia" target="_blank" rel="nofollow" data-placement="bottom" title="tutorialspoint @ Facebook"><i class="fab fa-facebook-f"></i></a> 
<a href="https://www.twitter.com/tutorialspoint" target="_blank" rel="nofollow" data-placement="bottom" title="tutorialspoint @ Twitter"><i class="fab fa-twitter"></i></a>
<a href="https://www.linkedin.com/company/tutorialspoint" target="_blank" rel="nofollow" data-placement="bottom" title="tutorialspoint @ Linkedin"><i class="fab fa-linkedin-in"></i></a>
<a href="https://www.youtube.com/channel/UCVLbzhxVTiTLiVKeGV7WEBg" target="_blank" rel="nofollow" data-placement="bottom" title="tutorialspoint YouTube"><i class="fab fa-youtube"></i></a>
</div>        
</div>
</div>
<!-- Top sub-menu Ends Here -->
<!-- Top main-menu Starts Here -->
<div class="mui-appbar mui-container-fulid mui--appbar-line-height mui--z1" id="logo-menu">
<div class="mui-container">
<div class="left-menu">
<a href="https://www.tutorialspoint.com/index.htm" title="Tutorialspoint">
<img class="tp-logo" alt="tutorialspoint" src="/sharepoint/images/logo.png">
</a>
<div class="mui-dropdown">
<a class="mui-btn mui-btn--primary categories" data-mui-toggle="dropdown"><i class="fa fa-th-large"></i> 
<span>Categories <span class="mui-caret"></span></span></a>            
<ul class="mui-dropdown__menu cat-menu">
<li>
<ul>
<li><a href="/academic_tutorials.htm"><i class="fa fa-caret-right"></i> Academic Tutorials</a></li>
<li><a href="/big_data_tutorials.htm"><i class="fa fa-caret-right"></i> Big Data &amp; Analytics </a></li>
<li><a href="/computer_programming_tutorials.htm"><i class="fa fa-caret-right"></i> Computer Programming </a></li>
<li><a href="/computer_science_tutorials.htm"><i class="fa fa-caret-right"></i> Computer Science </a></li>
<li><a href="/database_tutorials.htm"><i class="fa fa-caret-right"></i> Databases </a></li>
<li><a href="/devops_tutorials.htm"><i class="fa fa-caret-right"></i> DevOps </a></li>
<li><a href="/digital_marketing_tutorials.htm"><i class="fa fa-caret-right"></i> Digital Marketing </a></li>
<li><a href="/engineering_tutorials.htm"><i class="fa fa-caret-right"></i> Engineering Tutorials </a></li>
<li><a href="/upsc_ias_exams.htm"><i class="fa fa-caret-right"></i> Exams Syllabus </a></li>
<li><a href="/famous_monuments.htm"><i class="fa fa-caret-right"></i> Famous Monuments </a></li>
<li><a href="/gate_exams_tutorials.htm"><i class="fa fa-caret-right"></i> GATE Exams Tutorials</a></li>
<li><a href="/latest_technologies.htm"><i class="fa fa-caret-right"></i> Latest Technologies </a></li>
<li><a href="/machine_learning_tutorials.htm"><i class="fa fa-caret-right"></i> Machine Learning </a></li>
<li><a href="/mainframe_tutorials.htm"><i class="fa fa-caret-right"></i> Mainframe Development </a></li>
<li><a href="/management_tutorials.htm"><i class="fa fa-caret-right"></i> Management Tutorials </a></li>
<li><a href="/maths_tutorials.htm"><i class="fa fa-caret-right"></i> Mathematics Tutorials</a></li>
<li><a href="/microsoft_technologies_tutorials.htm"><i class="fa fa-caret-right"></i> Microsoft Technologies </a></li>
<li><a href="/misc_tutorials.htm"><i class="fa fa-caret-right"></i> Misc tutorials </a></li>
<li><a href="/mobile_development_tutorials.htm"><i class="fa fa-caret-right"></i> Mobile Development </a></li>
<li><a href="/java_technology_tutorials.htm"><i class="fa fa-caret-right"></i> Java Technologies </a></li>
<li><a href="/python_technologies_tutorials.htm"><i class="fa fa-caret-right"></i> Python Technologies </a></li>
<li><a href="/sap_tutorials.htm"><i class="fa fa-caret-right"></i> SAP Tutorials </a></li>
<li><a href="/scripting_lnaguage_tutorials.htm"><i class="fa fa-caret-right"></i>Programming Scripts </a></li>
<li><a href="/selected_reading.htm"><i class="fa fa-caret-right"></i> Selected Reading </a></li>
<li><a href="/software_quality_tutorials.htm"><i class="fa fa-caret-right"></i> Software Quality </a></li>
<li><a href="/soft_skill_tutorials.htm"><i class="fa fa-caret-right"></i> Soft Skills </a></li>
<li><a href="/telecom_tutorials.htm"><i class="fa fa-caret-right"></i> Telecom Tutorials </a></li>
<li><a href="/upsc_ias_exams.htm"><i class="fa fa-caret-right"></i> UPSC IAS Exams </a></li>
<li><a href="/web_development_tutorials.htm"><i class="fa fa-caret-right"></i> Web Development </a></li>
<li><a href="/sports_tutorials.htm"><i class="fa fa-caret-right"></i> Sports Tutorials </a></li>
<li><a href="/xml_technologies_tutorials.htm"><i class="fa fa-caret-right"></i> XML Technologies </a></li>
<li><a href="/multi_language_tutorials.htm"><i class="fa fa-caret-right"></i> Multi-Language Tutorials</a></li>
<li><a href="/questions_and_answers.htm"><i class="fa fa-caret-right"></i> Interview Questions</a></li>
</ul>
</li>
</ul>
<div class="clear"></div>
</div> 
</div>
<div class="right-menu">
<div class="toc-toggle">
<a href="javascript:void(0);"><i class="fa fa-bars"></i></a>
</div>
<div class="mobile-search-btn">
<a href="https://www.tutorialspoint.com/search.htm"><i class="fal fa-search"></i></a>
</div>
<div class="search-box">
<form method="get" class="" name="searchform" action="https://www.google.com/search" target="_blank" novalidate="">
<input type="hidden" name="sitesearch" value="www.tutorialspoint.com" class="user-valid valid">
<input class="header-search-box" type="text" id="search-string" name="q" placeholder="Search your favorite tutorials..." onfocus="if (this.value == 'Search your favorite tutorials...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search your favorite tutorials...';}" autocomplete="off">
<button><i class="fal fa-search"></i></button>
</form>
</div>
<div class="menu-btn library-btn">
<a href="https://www.tutorialspoint.com/tutorialslibrary.htm"><i class="fal fa-cubes"></i> <span>Library</span></a>
</div>
<div class="menu-btn videos-btn">
<a href="https://www.tutorialspoint.com/videotutorials/index.htm"><i class="fal fa-video"></i> <span>Videos</span></a> 
</div>
<div class="menu-btn videos-btn">
<a href="https://www.tutorialspoint.com/questions/index.php"><i class="fa fa-location-arrow"></i> <span>Q/A</span></a>
</div>
<div class="menu-btn ebooks-btn">
<a href="https://store.tutorialspoint.com"><i class="fal fa-book"></i> <span>eBooks</span></a>
</div>
<div class="mui-dropdown">
<button class="mui-btn mui-btn--primary" data-mui-toggle="dropdown">
<span class="mui-caret"></span>
</button>
<ul class="mui-dropdown__menu">
<li><a href="https://www.tutorialspoint.com/tutorialslibrary.htm"><i class="fal fa-cubes"></i> <span>Library</span></a></li>
<li><a href="https://www.tutorialspoint.com/videotutorials/index.htm"><i class="fal fa-video"></i> <span>Videos</span></a></li>
<li><a href="https://store.tutorialspoint.com"><i class="fal fa-book"></i> <span>eBooks</span></a></li>
</ul>
</div>
</div>
</div>
</div>
<!-- Top main-menu Ends Here -->
</header>
<div class="mui-container-fluid content">
<div class="mui-container">
<!-- Tutorial ToC Starts Here -->
<div class="mui-col-md-3 tutorial-toc">
<div class="mini-logo">
<img src="/sharepoint/images/sharepoint-mini-logo.jpg" alt="SharePoint Tutorial" />
</div>
<ul class="toc chapters">
<li class="heading">SharePoint Tutorial</li>
<li><a href="/sharepoint/index.htm">SharePoint - Home</a></li>
<li><a href="/sharepoint/sharepoint_overview.htm">SharePoint - Overview</a></li>
<li><a href="/sharepoint/sharepoint_types.htm">SharePoint - Types</a></li>
<li><a href="/sharepoint/sharepoint_capabilities.htm">SharePoint - Capabilities</a></li>
<li><a href="/sharepoint/sharepoint_setup_environment.htm">SharePoint - Setup Environment</a></li>
<li><a href="/sharepoint/sharepoint_create_site_collection.htm">SharePoint - Create Site Collection</a></li>
<li><a href="/sharepoint/sharepoint_apis.htm">SharePoint - APIs</a></li>
<li><a href="/sharepoint/sharepoint_central_administration.htm">SharePoint - Central Administration</a></li>
<li><a href="/sharepoint/sharepoint_app_model.htm">SharePoint - App Model</a></li>
<li><a href="/sharepoint/sharepoint_integration_options.htm">SharePoint - Integration Options</a></li>
<li><a href="/sharepoint/sharepoint_development_tools.htm">SharePoint - Development Tools</a></li>
<li><a href="/sharepoint/sharepoint_list_functionality.htm">SharePoint - List Functionality</a></li>
<li><a href="/sharepoint/sharepoint_additional_list_functionality.htm">Additional List Functionality</a></li>
<li><a href="/sharepoint/sharepoint_custom_list.htm">SharePoint - Custom List</a></li>
<li><a href="/sharepoint/sharepoint_libraries.htm">SharePoint - Libraries</a></li>
<li><a href="/sharepoint/sharepoint_web_part.htm">SharePoint - Web Part</a></li>
<li><a href="/sharepoint/sharepoint_site_column_and_content_types.htm">Site Column &amp; Content Types</a></li>
<li><a href="/sharepoint/sharepoint_data.htm">SharePoint - Data</a></li>
<li><a href="/sharepoint/sharepoint_server_object_model.htm">SharePoint - Server Object Model</a></li>
<li><a href="/sharepoint/sharepoint_client_object_model.htm">SharePoint - Client Object Model</a></li>
<li><a href="/sharepoint/sharepoint_rest_apis.htm">SharePoint - REST APIs</a></li>
<li><a href="/sharepoint/sharepoint_features_and_elements.htm">SharePoint - Features &amp; Elements</a></li>
<li><a href="/sharepoint/sharepoint_feature_event_receiver.htm">SharePoint - Feature\Event Receiver</a></li>
<li><a href="/sharepoint/sharepoint_azure_platform.htm">SharePoint - Azure Platform</a></li>
<li><a href="/sharepoint/sharepoint_packaging_and_deploying.htm">SharePoint - Packaging &amp; Deploying</a></li>
<li><a href="/sharepoint/sharepoint_sandbox_solutions.htm">SharePoint - Sandbox Solutions</a></li>
<li><a href="/sharepoint/sharepoint_apps.htm">SharePoint - Apps</a></li>
</ul>
<ul class="toc chapters">
<li class="heading">SharePoint Useful Resources</li>
<li><a href="/sharepoint/sharepoint_quick_guide.htm">SharePoint - Quick Guide</a></li>
<li><a href="/sharepoint/sharepoint_useful_resources.htm">SharePoint - Resources</a></li>
<li><a href="/sharepoint/sharepoint_discussion.htm">SharePoint - Discussion</a></li>
</ul>
<ul class="toc reading">
<li class="sreading">Selected Reading</li>
<li><a target="_top" href="/upsc_ias_exams.htm">UPSC IAS Exams Notes</a></li>
<li><a target="_top" href="/developers_best_practices/index.htm">Developer's Best Practices</a></li>
<li><a target="_top" href="/questions_and_answers.htm">Questions and Answers</a></li>
<li><a target="_top" href="/effective_resume_writing.htm">Effective Resume Writing</a></li>
<li><a target="_top" href="/hr_interview_questions/index.htm">HR Interview Questions</a></li>
<li><a target="_top" href="/computer_glossary.htm">Computer Glossary</a></li>
<li><a target="_top" href="/computer_whoiswho.htm">Who is Who</a></li>
</ul>
</div>
<!-- Tutorial ToC Ends Here -->
<!-- Tutorial Content Starts Here -->
<div class="mui-col-md-6 tutorial-content">
<h1>SharePoint - Server Object Model</h1>
<hr />
<div class="top-ad-heading">Advertisements</div>
<div style="text-align: center;">
<script><!--
google_ad_client = "pub-7133395778201029";
var width = document.getElementsByClassName("tutorial-content")[0].clientWidth - 40;
google_ad_width = width;
google_ad_height = 150;
google_ad_format = width + "x150_as";
google_ad_type = "image";
google_ad_channel = "";
//--></script>
<script src="https://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
<div class="mui-container-fluid button-borders">
<div class="pre-btn">
<a href="/sharepoint/sharepoint_data.htm"><i class="fal fa-chevron-circle-left"></i> Previous Page</a>
</div>
<div class="nxt-btn">
<a href="/sharepoint/sharepoint_client_object_model.htm">Next Page <i class="fal fa-chevron-circle-right"></i>&nbsp;</a>
</div>
</div>
<div class="clearer"></div>
<p>In this chapter, we will take a look at the SharePoint Server Object Model. You use the SharePoint Server Object Model when you are writing code that will run inside the context of SharePoint. Some common examples would be the code-behind in a page or a web part, event handlers behind a feature or a list, timer jobs etc.</p>
<h2>Features of Server Object Model</h2>
<p>Following are the key features of Server Object Model</p>
<ul class="list">
<li><p>You can use the Server Object Model if you are programming an ASP.NET application inside the same application pool that is used by SharePoint.</p></li>
<li><p>Server Object Model can be used if you are developing a client application such as console or Windows forms or a WPF app that will run on a SharePoint server.</p></li>
<li><p>You cannot use the Server Object Model to connect remotely to a SharePoint Server.</p></li>
<li><p>When you want to use the Server Object Model, you refer to the <b>Microsoft.SharePoint</b> assembly. There are other assemblies, which make up the Server Object Model, but Microsoft.SharePoint is the main one.</p></li>
<li><p>The core types that you will use most commonly map to the components that you use as an end user, so things like site collections, sites, list, libraries, and list items are represented by the types SPSite, SPWeb, SPList, SPDocumentLibrary, and SPListItem.</p></li>
<li><p>The type and the Server Object Model that represents a site collection is SPSite and the type that represents a SharePoint site in the Server Object Model is SPWeb. Therefore, when you go from the end user terms to the developer terms, you will just have to do that mental mapping.</p></li>
</ul>
<p>Now when you first start using SharePoint, it can be confusing because site is so overloaded and it means opposite things in the end user and developer vocabularies, not to mention the web vocabulary.</p>
<p>Let us have a look at a simple example of Server Object Model.</p>
<p><b>Step 1</b> &minus; Open Visual Studio and create a new project from <b>File &rarr; New &rarr; Project</b> menu option.</p>
<p><b>Step 2</b> &minus; Select Windows from <b>Templates &rarr; Visual C#</b> in the left pane and choose Console Application in the middle pane. Enter the name of your project and click OK.</p>
<p><b>Step 3</b> &minus; Once the project is created, right-click the project in Solution Explorer and select <b>Add &rarr; References</b>.</p>
<img src="/sharepoint/images/console_application.jpg" alt="Console Application" />
<p><b>Step 4</b> &minus; Select <b>Assemblies &rarr; Extensions</b> in the left pane and check Microsoft.SharePoint in middle pane and click Ok button.</p>
<p>Now right-click again the project in Solution Explorer and select Properties.</p>
<img src="/sharepoint/images/assemblies.jpg" alt="Assemblies" />
<p><b>Step 5</b> &minus; Click the <b>Build</b> Tab in the left pane and uncheck the <b>Prefer 32-bit</b> option.</p>
<img src="/sharepoint/images/build_tab.jpg" alt="Build Tab" />
<p><b>Step 6</b> &minus; Now go back to the <b>Program.cs</b> file and replace it with the following code.</p>
<pre class="prettyprint notranslate">
using Microsoft.SharePoint;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace SharePointData {
   class Program {
      static void Main(string[] args) {
         using (var site = new SPSite("http://waqasserver/sites/demo")) {
            var web = site.RootWeb;
            Console.WriteLine(web.Title);
            var lists = web.Lists;
            
            foreach (SPList list in lists) {
               Console.WriteLine("\t" + list.Title);
            }
            Console.ReadLine();
         }
      }
   }
}
</pre>
<p><b>Note</b> &minus; In the above code first created a new SPSite object. This is a disposable object, so it is created within a using statement. The SPSite constructor takes in the URL to the site collection, which will be different in your case.</p>
<p>The var <b>web = site.RootWeb</b> will get the root of the site collection.</p>
<p>We can get the lists using web.Lists and print the title of the list items.</p>
<p>When the above code is compiled and executed, you will see the following output &minus;</p>
<pre class="result notranslate">
SharePoint Tutorials
   appdata
   Authors
   Composed Looks
   Contacts
   Course Documents
   Courses
   Documents
   List Template Gallery
   Master Page Gallery
   Site Assets
   Site Pages
   Solution Gallery
   Style Library
   Theme Gallery
   User Information List
   Web Part Gallery
</pre>
<p>You can see that these titles are Solutions Gallery, the Style Library, Form Templates. These are lists that are used internally by SharePoint. Therefore, instead of displaying all the lists, maybe you only want to show the lists that the users would normally see.</p>
<p>Hence, instead of getting the entire list collection, we want to get all the lists that are not hidden. We can do that using a link query as given below.</p>
<pre class="prettyprint notranslate">
using Microsoft.SharePoint;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ServerObjectModel {
   class Program {
      static void Main(string[] args) {
         using (var site = new SPSite("http://waqasserver/sites/demo")) {
            var web = site.RootWeb;
            Console.WriteLine(web.Title);
            var lists = from SPList list in web.Lists
            where list.Hidden == false
            select list;
            
            foreach (SPList list in lists) {
               Console.WriteLine("\t" + list.Title);
            }
            Console.ReadLine();
         }
      }
   }
}
</pre>
<p>When the above code is compiled and executed, you will see the following output &minus;</p>
<pre class="result notranslate">
SharePoint Tutorials
   Authors
   Contacts
   Course Documents
   Courses
   Documents
   Site Assets
   Site Pages
   Style Library
</pre>
<p>You can see that this will give us back all the lists that are not hidden.</p>
<p>Let us have a look at another simple example in which we will also display some information about the list items.</p>
<pre class="prettyprint notranslate">
using Microsoft.SharePoint;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ServerObjectModel {
   class Program {
      static void Main(string[] args) {
         using (var site = new SPSite("http://waqasserver/sites/demo")) {
            var web = site.RootWeb;
            Console.WriteLine(web.Title);
            var lists = from SPList list in web.Lists
            where list.Hidden == false
            select list;
            
            foreach (SPList list in lists) {
               Console.WriteLine("\t" + list.Title);
               var items = list.Items.OfType&lt;SPListItem&gt;().Take(5);
               var isDocLib = list is SPDocumentLibrary;
               
               foreach (SPListItem item in items) {
                  var value = isDocLib ? item.Name : item.Title;
                  Console.WriteLine("\t\t" + value);
               }
            }
            Console.ReadLine();
         }
      }
   }
}
</pre>
<p>When the above code is compiled and executed, you will see the following output &minus;</p>
<pre class="result notranslate">
SharePoint Tutorials
   Authors
      Muhammad Waqas
      Mark Upston
      Allan Bommer
      Andy Onian
   Contacts
      Waqas
      Upston
      Bommer
   Course Documents
      Sample1.docx
      Sample2.docx
      Sample3.docx
   Courses
      SharePoint Tutorials
      C# Tutorials
      ASP.Net Tutorials
      NHibernate Tutorials
   Documents
   Site Assets
   Site Pages
      Home.aspx
      How To Use This Library.aspx
   Style Library
</pre>
<h2>List Data</h2>
<p>When you first create a list, it always has a title column. This Title column gives access, by default, to the List Item context or edit control block menu.</p>
<p>Since, every list starts with a column- Title, the <b>SPListItem</b> type exposes that as a property. For the columns that are not common to every single list, you can access them via the indexer on <b>SpListItem</b> type.</p>
<p>You can pass a couple of pieces of information to the indexer, but the most common one is the <b>Column</b>. The end users in the list settings can change this name. You do not want to use this name because again, it can change.</p>
<p>The second is the <b>InternalName</b>, which is set at the point this list is created and it never changes. This is the name you want to use when you are accessing the column value.</p>
<p>Let us have a look at simple example in which we will retrieve the Authors list as shown below &minus;</p>
<img src="/sharepoint/images/simple_example.jpg" alt="Simple Example" />
<p>In this example, we will get the Authors list and then raise the Salary/Rate by some value. Therefore, for Salary/Rate column we will be using the <b>InternalName</b>.</p>
<p><b>Step 1</b> &minus; Go to the Server Explorer; right-click <b>SharePoint Connections</b> and select Add Connection... Specify the URL and click OK.</p>
<img src="/sharepoint/images/sharepoint_connections.jpg" alt="SharePoint Connections" />
<p><b>Step 2</b> &minus; Expand <b>SharePoint Tutorials &rarr; List Libraries &rarr; Lists &rarr; Authors &rarr; Fields &rarr; Salary/Rate</b> field. Right-click <b>Salary/Rate</b> and select Properties. You will see the <b>InternalName</b> in the Properties window.</p>
<img src="/sharepoint/images/sharepoint_tutorials.jpg" alt="SharePoint Tutorials" />
<p><b>Step 3</b> &minus; Given below is a simple example of retrieving the Authors based on Salary/Rate and raise their Salary/Rate.</p>
<pre class="prettyprint notranslate">
using Microsoft.SharePoint;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ServerObjectModel {
   class Program {
      static void Main(string[] args) {
         using (var site = new SPSite("http://waqasserver/sites/demo")) {
            var web = site.RootWeb;
            var list = web.Lists.TryGetList("Authors");
            if (list == null)
            return;
            var items = list.Items;
            ShowItems(items);
            RaiseRates(items);
            Console.WriteLine("\nAfter Raise\n");
            ShowItems(items);
            Console.ReadKey();
         }
      }
      static void RaiseRates(SPListItemCollection items) {
         foreach (SPListItem item in items) {
            var employee = Convert.ToBoolean(item["Employee"]);
            var rate = Convert.ToDouble(item["Salary_x002f_Rate"]);
            var newRate = employee ? rate + 1 : rate + 0.1;
            item["Salary_x002f_Rate"] = newRate;
            item.Update();
         }
      }
      static void ShowItems(SPListItemCollection items) {
         foreach (SPListItem item in items) {
            Console.WriteLine("Salary or rate for {0} is {1:c}", item.Title,
            item["Salary_x002f_Rate"]);
         }
      }
   }
}
</pre>
<p>In the above code you can see that we have two methods &minus;</p>
<ul class="list">
<li><p>One is retrieving the list which is called <b>ShowItems</b> and</p></li>
<li><p>The other method is raising the Rates which is called <b>RaiseRates()</b>.</p></li>
</ul>
<p>When the above code is compiled and executed, you will see the following output &minus;</p>
<pre class="result notranslate">
Salary or rate for Muhammad Waqas is $950.00
Salary or rate for Mark Upston is $15.00
Salary or rate for Allan Bommer is $20.00
Salary or rate for Andy Onian is $870.00

After Raise

Salary or rate for Muhammad Waqas is $951.00
Salary or rate for Mark Upston is $15.10
Salary or rate for Allan Bommer is $20.10
Salary or rate for Andy Onian is $871.00
</pre>
<h2>CAML Queries</h2>
<p>In the above examples, we have always iterated through the items using a foreach loop many times iterating through all of the items and we have always brought back all of the columns or at least all the columns have been accessible.</p>
<p>It is really analogues to doing a select* from table name in a SQL query.</p>
<p>We can address this issue by using what are called <b>CAML queries</b>. When doing a CAML query you have two options &minus;</p>
<ul class="list">
<li><p>If you want to query just a single list, you can use the SPQuery object.</p></li>
<li><p>If you want to query multiple lists in a site collection, then you can use the SPSiteDataQuery.</p></li>
</ul>
<p></p>
<p>Generally, when you are doing the <b>SPSiteDataQuery</b>, you are querying all the lists of a specific type.</p>
<p>For example, I want to query all of the contact lists etc. SPSiteDataQuery allows you to determine the scope, so you can indicate that you want to query the entire site collection, an individual site, or the site and all of its children.</p>
<p>The syntax for CAML queries is basically described in XML format and it takes a little bit of time to get used to constructing these kinds of queries.</p>
<p>Let us have a look at a simple example of CAML Queries. Here, we will create a CAML query to query the data in our Authors list.</p>
<pre class="prettyprint notranslate">
using Microsoft.SharePoint;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ServerObjectModel {
   class Program {
      static void Main(string[] args) {
         using (var site = new SPSite("http://waqasserver/sites/demo")) {
            var web = site.RootWeb;
            var list = web.Lists.TryGetList("Authors");
            if (list == null)
            return;
            var items = QueryItems(list);
            ShowItems(items);
            
            //RaiseRates(items);
            //Console.WriteLine("\nAfter Raise\n");
            //ShowItems(items);
            Console.ReadKey();
         }
      }
      static SPListItemCollection QueryItems(SPList list) {
         var query = new SPQuery();
         
         query.ViewFields =
            "&lt;FieldRef Name='Title' /&gt;" +
            "&lt;FieldRef Name='Employee' /&gt;" +
            "&lt;FieldRef Name='Salary_x002f_Rate' /&gt;";
         
         query.Query =
            "&lt;OrderBy&gt;" +
            " &lt;FieldRef Name='Salary_x002f_Rate' /&gt;" +
            "&lt;/OrderBy&gt;" +
            "&lt;Where&gt;" +
            " &lt;Eq&gt;" +
            " &lt;FieldRef Name='Employee' /&gt;" +
            " &lt;Value Type='Boolean'&gt;False&lt;/Value&gt;" +
            " &lt;/Eq&gt;" +
            "&lt;/Where&gt;";
         return list.GetItems(query);
      }
      static void RaiseRates(SPListItemCollection items) {
         foreach (SPListItem item in items) {
            var employee = Convert.ToBoolean(item["Employee"]);
            var rate = Convert.ToDouble(item["Salary_x002f_Rate"]);
            var newRate = employee ? rate + 1 : rate + 0.1;
            item["Salary_x002f_Rate"] = newRate;
            item.Update();
         }
      }
      static void ShowItems(SPListItemCollection items) {
         foreach (SPListItem item in items) {
            Console.WriteLine("Salary or rate for {0} is {1:c}",
            item.Title,
            item["Salary_x002f_Rate"]);
         }
      }
   }
}
</pre>
<p>We have used a CAML query to get some of the items. In the <b>QueryItems</b> method, you can see that we have retrieved only those items which are not Employee.</p>
<pre class="result notranslate">
Salary or rate for Mark Upston is $15.10
Salary or rate for Allan Bommer is $20.10
</pre>
<div class="mui-container-fluid button-borders show">
<div class="pre-btn">
<a href="/sharepoint/sharepoint_data.htm"><i class="fal fa-chevron-circle-left"></i> Previous Page</a>
</div>
<div class="nxt-btn">
<a href="/sharepoint/sharepoint_client_object_model.htm">Next Page <i class="fal fa-chevron-circle-right"></i>&nbsp;</a>
</div>
</div>
<div class="google-bottom-ads">
<div>Advertisements</div>
<script><!--
var width = 580;
var height = 400;
var format = "580x400_as";
if( window.innerWidth < 468 ){
   width = 300;
   height = 250;
   format = "300x250_as";
}
google_ad_client = "pub-7133395778201029";
google_ad_width = width;
google_ad_height = height;
google_ad_format = format;
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script src="https://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<div class="space-bottom"></div>
</div>
</div>
<!-- Tutorial Content Ends Here -->
<!-- Right Column Starts Here -->
<div class="mui-col-md-2 google-right-ads">
<div class="space-top"></div>
<div class="google-right-ad" style="margin: 0px auto !important;margin-top:5px;">
<script><!--
google_ad_client = "pub-2537027957187252";
google_ad_width = 300;
google_ad_height = 250;
google_ad_format = "300x250_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script src="https://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
<div class="google-right-ad">
<div class="adsbyvli" data-ad-slot="vi_9012177"></div>
<script>(vitag.Init = window.vitag.Init || []).push(function(){viAPItag.display("vi_9012177")})</script>
</div>
<div class="space-bottom"></div>
<div class="google-right-ad">
<div class="adsbyvli" data-ad-slot="vi_9013289"></div>
<script>(vitag.Init = window.vitag.Init || []).push(function(){viAPItag.display("vi_9013289")})</script>
</div>
<div class="space-bottom" style="margin-bottom:15px;"></div>
</div>
<!-- Right Column Ends Here -->
</div>
</div>
<div class="clear"></div>
<footer id="footer">
<div class="mui--text-center">
<div class="mui--text-caption mui--text-light">
<a href="/index.htm" class="logo"><img class="img-responsive" src="/images/logo-black.png" alt="Tutorials Point" title="Tutorials Point"></a>
</div>
<ul class="mui-list--inline mui--text-body2 mui--text-light">
<li><a href="/about/index.htm"><i class="fal fa-globe"></i> About us</a></li>
<li><a href="/about/about_terms_of_use.htm"><i class="fal fa-asterisk"></i> Terms of use</a></li>
<li><a href="/about/about_privacy.htm#cookies"> <i class="fal fa-shield-check"></i> Cookies Policy</a></li>
<li><a href="/about/faq.htm"><i class="fal fa-question-circle"></i> FAQ's</a></li>
<li><a href="/about/about_helping.htm"><i class="fal fa-hands-helping"></i> Helping</a></li>
<li><a href="/about/contact_us.htm"><i class="fal fa-map-marker-alt"></i> Contact</a></li>
</ul>
<div class="mui--text-caption mui--text-light bottom-copyright-text">&copy; Copyright 2019. All Rights Reserved.</div>
</div>
<div id="privacy-banner">
  <div>
    <p>
      We use cookies to provide and improve our services. By using our site, you consent to our Cookies Policy.
      <a id="banner-accept" href="#">Accept</a>
      <a id="banner-learn" href="/about/about_cookies.htm" target="_blank">Learn more</a>
    </p>
  </div>
</div>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-232293-17"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-232293-6');
</script>
</footer>
</body>
</html>
